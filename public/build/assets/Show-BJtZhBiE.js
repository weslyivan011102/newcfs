import{a as A,j as e,M as E,r as R}from"./app-BdyLqLlc.js";import{A as I}from"./AuthenticatedLayout-C8D8eUzt.js";import{l as v}from"./index-BzPIjsZP.js";import"./NavLink-BvgaK94k.js";import"./index-B7gYL_ii.js";const Y=({transactions:a,grand_totals:C,filters:L})=>{var f,S,D,F;const _=A.useRef(),B=v.useReactToPrint({contentRef:_}),x={"n/a":"SELECT MONTH",january:"JAN BILL",february:"FEB BILL",march:"MAR BILL",april:"APR BILL",may:"MAY BILL",june:"JUN BILL",july:"JUL BILL",august:"AUG BILL",september:"SEP BILL",october:"OCT BILL",november:"NOV BILL",december:"DEC BILL"},d=a.reduce((t,s)=>{const r=s.mode_payment||"UNKNOWN";return t[r]||(t[r]={rows:[],totals:{partial:0,rebate:0,balance:0}}),t[r].rows.push(s),t[r].totals.partial+=parseFloat(s.partial),t[r].totals.rebate+=parseFloat(s.rebate),t[r].totals.balance+=parseFloat(s.outstanding_balance),t},{}),O=["january","february","march","april","may","june","july","august","september","october","november","december"],w=t=>{const s=Object.keys(x).find(r=>x[r]===t);return O.indexOf(s)},T=new Date(L.start_date).getMonth(),N=a.filter(t=>{const s=x[t.description]||t.description,r=w(s);return r!==-1&&r<T}),y=Object.values(d).reduce((t,s)=>(t.partial+=s.totals.partial,t.rebate+=s.totals.rebate,t.balance+=s.totals.balance,t),{partial:0,rebate:0,balance:0}),u=N.reduce((t,s)=>(t.partial+=parseFloat(s.partial),t.rebate+=parseFloat(s.rebate),t.balance+=parseFloat(s.outstanding_balance),t),{partial:0,rebate:0,balance:0}),g={partial:y.partial,rebate:y.rebate,balance:y.balance};return e.jsxs(I,{children:[e.jsx(E,{title:"Collections"}),e.jsx("div",{className:"flex justify-end px-8 mb-2",children:e.jsx(R.Button,{variant:"gradient",color:"green",onClick:()=>B(),children:"Print"})}),e.jsxs("div",{ref:_,className:"w-full px-4 mx-auto bg-white py-8",children:[e.jsx("div",{className:"flex items-start justify-between border-b pb-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("img",{src:"/img/logo.png",className:"w-10 h-10 object-contain"}),e.jsx("div",{className:"text-sm text-gray-800",children:e.jsx("h1",{className:"font-bold text-[10px]",children:"CFS INTERNET NETWORK SOLUTIONS"})})]})}),e.jsx("div",{className:"flex justify-between items-center my-4 border-b pb-2",children:e.jsxs("div",{className:"text-[10px] text-gray-800",children:[e.jsxs("h1",{children:["Collection Report"," ",e.jsx("span",{className:"font-semibold",children:(S=(f=a[0])==null?void 0:f.customer_plan)!=null&&S.collector?`by ${a[0].customer_plan.collector.firstname} ${a[0].customer_plan.collector.lastname}`:":"})]}),e.jsxs("p",{className:"mt-1",children:["Collection No.:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=new Date,s=t.getFullYear().toString().slice(-2),r=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),n=t.toISOString().split("T")[0],i=a.filter(o=>new Date(o.created_at).toISOString().split("T")[0]===n),c=String(i.length+1).padStart(2,"0");return`${s}-${r}-${l}-${c}`})()})]})]})}),e.jsx("div",{className:"flex justify-between items-center my-4 border-b pb-2",children:e.jsxs("h2",{className:"font-semibold text-gray-700 text-[10px]",children:["Collection of"," ",new Date(L.start_date).toLocaleDateString("en-PH",{day:"2-digit",month:"long",year:"numeric"})]})}),Object.keys(d).map(t=>e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"text-[12px] font-bold mb-2 mt-6 bg-gray-200 px-3 py-2 uppercase",children:["PAYMENT MODE: ",t]}),e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 text-left text-[6px]",children:[e.jsx("th",{className:"border px-2 py-1",children:"#"}),e.jsx("th",{className:"border px-5 py-1",children:"Bill No."}),e.jsx("th",{className:"border px-2 py-1",children:"Billing Date"}),e.jsx("th",{className:"border px-2 py-1",children:"Description"}),e.jsx("th",{className:"border px-2 py-1",children:"Customer Name"}),e.jsx("th",{className:"border px-2 py-1",children:"Address"}),e.jsx("th",{className:"border px-2 py-1",children:"Payment"}),e.jsx("th",{className:"border px-2 py-1",children:"Rebate"}),e.jsx("th",{className:"border px-2 py-1",children:"Balance"}),e.jsx("th",{className:"border px-2 py-1",children:"Status"})]})}),e.jsx("tbody",{children:d[t].rows.map((s,r)=>{var l,n,i,c,o,p,m,h,b,j,P;return e.jsxs("tr",{children:[e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:r+1}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:s.bill_no}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:new Date(s.date_billing).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:x[s.description]||s.description}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:[(n=(l=s.customer_plan)==null?void 0:l.customer)==null?void 0:n.lastname,","," ",(c=(i=s.customer_plan)==null?void 0:i.customer)==null?void 0:c.firstname]}),e.jsxs("td",{className:"border px-0.5 py-1 text-[7px]",children:[(m=(p=(o=s.customer_plan)==null?void 0:o.customer)==null?void 0:p.purok)==null?void 0:m.purok_name,","," ",(P=(j=(b=(h=s.customer_plan)==null?void 0:h.customer)==null?void 0:b.purok)==null?void 0:j.barangay)==null?void 0:P.barangay_name]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",s.partial.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",s.rebate.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",s.outstanding_balance.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:s.status})]},s.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100 font-semibold text-[7px]",children:[e.jsxs("td",{colSpan:"6",className:"border px-2 py-1 text-right",children:["TOTAL FOR ",t,":"]}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",d[t].totals.partial.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",d[t].totals.rebate.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",d[t].totals.balance.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsx("td",{className:"border"})]})})]})]},t)),N.length>0&&e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-[12px] font-bold mb-2 mt-6 bg-red-200 px-3 py-2 uppercase",children:"ARREARS"}),e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 text-left text-[6px]",children:[e.jsx("th",{className:"border px-2 py-1",children:"#"}),e.jsx("th",{className:"border px-5 py-1",children:"Bill No."}),e.jsx("th",{className:"border px-2 py-1",children:"Billing Date"}),e.jsx("th",{className:"border px-2 py-1",children:"Description"}),e.jsx("th",{className:"border px-2 py-1",children:"Customer Name"}),e.jsx("th",{className:"border px-2 py-1",children:"Address"}),e.jsx("th",{className:"border px-2 py-1",children:"Payment"}),e.jsx("th",{className:"border px-2 py-1",children:"Rebate"}),e.jsx("th",{className:"border px-2 py-1",children:"Balance"}),e.jsx("th",{className:"border px-2 py-1",children:"Status"})]})}),e.jsx("tbody",{children:N.map((t,s)=>{var r,l,n,i,c,o,p,m,h,b,j;return e.jsxs("tr",{children:[e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:s+1}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:t.bill_no}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:new Date(t.date_billing).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:x[t.description]||t.description}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:[(l=(r=t.customer_plan)==null?void 0:r.customer)==null?void 0:l.lastname,", ",(i=(n=t.customer_plan)==null?void 0:n.customer)==null?void 0:i.firstname]}),e.jsxs("td",{className:"border px-0.5 py-1 text-[7px]",children:[(p=(o=(c=t.customer_plan)==null?void 0:c.customer)==null?void 0:o.purok)==null?void 0:p.purok_name,", ",(j=(b=(h=(m=t.customer_plan)==null?void 0:m.customer)==null?void 0:h.purok)==null?void 0:b.barangay)==null?void 0:j.barangay_name]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",t.partial.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",t.rebate.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-[7px]",children:["₱",t.outstanding_balance.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsx("td",{className:"border px-2 py-1 text-[7px]",children:t.status})]},t.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100 font-semibold text-[7px]",children:[e.jsx("td",{colSpan:"6",className:"border px-2 py-1 text-right",children:"TOTAL ARREARS:"}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",u.partial.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",u.rebate.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1 text-right",children:["₱",u.balance.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsx("td",{className:"border"})]})})]})]}),e.jsxs("div",{className:"mt-10 w-full max-w-md mx-auto",children:[e.jsx("h2",{className:"text-[12px] font-bold mb-2 bg-green-200 px-3 py-2 uppercase",children:"TOTAL COLLECTION"}),e.jsxs("table",{className:"w-full border-collapse text-[7px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 text-center",children:[e.jsx("th",{className:"border px-2 py-1",children:"Payment"}),e.jsx("th",{className:"border px-2 py-1",children:"Rebate"}),e.jsx("th",{className:"border px-2 py-1",children:"Balance"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"font-semibold text-[7px] text-center",children:[e.jsxs("td",{className:"border px-2 py-1",children:["₱",g.partial.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1",children:["₱",g.rebate.toLocaleString("en-PH",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border px-2 py-1",children:["₱",g.balance.toLocaleString("en-PH",{minimumFractionDigits:2})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 text-center mt-12 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold uppercase text-[12px] underline",children:(F=(D=a[0])==null?void 0:D.customer_plan)!=null&&F.collector?`${a[0].customer_plan.collector.firstname} ${a[0].customer_plan.collector.lastname}`:"___________________"}),e.jsx("p",{className:"text-[12px]",children:"Collector:"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold uppercase text-[12px] underline",children:"MELONY A. BARCELO"}),e.jsx("p",{className:"text-[12px]",children:"Checked By:"})]})]})]})]})};export{Y as default};
